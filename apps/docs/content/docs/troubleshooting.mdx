---
title: Troubleshooting
description: Common issues and solutions.
icon: BadgeAlert
---

## SSH Connection Issues

### Host Key Verification Failed

**Symptom**:
```
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@    WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!     @
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
```

**Cause**: Server Host Key changed after redeployment.

**Solution**:
```bash
# Remove old Host Key
ssh-keygen -R "[tunnl.example.com]:2222"

# Reconnect
ssh -R 8000:localhost:8000 -p 2222 user@tunnl.example.com
```

### Connection Timeout

**Symptom**:
```
ssh: connect to host tunnl.example.com port 2222: Connection timed out
```

**Troubleshooting Steps**:

1. Check if port is open:
   ```bash
   nc -zv tunnl.example.com 2222
   ```

2. Check firewall rules:
   ```bash
   # Cloud server security groups need to allow port 2222
   ```

3. Check if service is running:
   ```bash
   docker compose ps
   docker compose logs tunnl
   ```

### Permission Denied

**Symptom**:
```
Permission denied (publickey).
```

**Cause**: Device Flow authentication not completed or timed out.

**Solution**:
- Make sure to complete browser authentication as prompted
- Authentication expires after 5 minutes, reconnect if timed out

### Port Mismatch Issue

**Important**: Due to SSH protocol limitations, the server **cannot** determine your actual local port. When the remote and local ports don't match, the connection will **NOT** close immediately, but the tunnel will not work correctly.

**Symptom**: Tunnel connects successfully, but requests cannot be properly routed to the local service.

**Cause**: Remote port and local port don't match in the `-R` parameter. The server can only see the remote port and has no way to know the actual local port.

**Solution**: **Always** ensure the remote and local ports are identical:

```bash
# ❌ Wrong - mismatched ports (connection won't close, but tunnel won't work)
ssh -R 8080:localhost:8000 -p 2222 user@your.domain

# ✅ Correct - matched ports
ssh -R 8000:localhost:8000 -p 2222 user@your.domain
```

> [!IMPORTANT]
> Both ports must be the same for the tunnel to work properly. Always keep the remote port in the `-R` parameter matching your local service port.

---

## Device Flow Authentication Issues

### Invalid Verification Code

**Symptom**: Browser shows "Code not found" or "Code expired".

**Cause**:
- Verification code entered incorrectly
- Authentication request timed out (5 minutes)

**Solution**:
```bash
# Disconnect and reconnect
# Press Enter then type ~.
# Reconnect to get a new verification code
ssh -R 8000:localhost:8000 -p 2222 user@tunnl.example.com
```

### Cannot Access Authentication Page

**Symptom**: Browser cannot open `https://tunnl.example.com/activate`.

**Troubleshooting Steps**:

1. Check if Web service is running:
   ```bash
   docker compose logs web
   ```

2. Check reverse proxy configuration:
   ```bash
   # Nginx
   nginx -t
   
   # Caddy
   caddy validate
   ```

---

## Tunnel Access Issues

### Subdomain Resolution Failed

**Symptom**:
```
curl: (6) Could not resolve host: abc123.tunnl.example.com
```

**Cause**: DNS wildcard record not configured.

**Solution**:
```
# Add DNS record
*.tunnl.example.com  A  <server IP>
```

### 502 Bad Gateway

**Symptom**: Accessing tunnel URL returns 502 error.

**Possible Causes**:

1. **Local service not running**
   ```bash
   # Make sure local service is running
   curl localhost:3000
   ```

2. **SSH tunnel disconnected**
   ```bash
   # Check if SSH connection is alive
   # Reconnect
   ssh -R 8000:localhost:8000 -p 2222 user@tunnl.example.com
   ```

3. **HTTP Proxy service error**
   ```bash
   docker compose logs tunnl | grep -i error
   ```

---

## Disconnecting SSH Connection

### Double-press ESC (Recommended)

Double-press the `ESC` key in the tunnel terminal to disconnect.

> [!TIP]
> The first ESC press shows a hint message. Press ESC again within 2 seconds to confirm disconnect.

### Using Ctrl+C

In SSH reverse tunnel mode, `Ctrl+C` should terminate the connection.

### Using Escape Sequence

```
1. Press Enter (ensure you're at the beginning of a new line)
2. Type ~. (tilde + period)
```

> [!TIP]
> If using nested SSH (SSH to jump host first, then SSH to EXLO), press `~` twice: `~~.`

### Terminate from Web Dashboard

1. Login to Web Dashboard
2. Navigate to tunnel list
3. Click "Disconnect" button for the corresponding tunnel

---

## Reconnection Issues

### Need to Re-authenticate After Reconnect

**Symptom**: After reconnecting, Device Flow authentication is required again.

**Possible Causes**:

1. **Over 30 minutes**: Authentication cache expires after 30 minutes
2. **Changed device/SSH key**: Reconnection is based on SSH public key fingerprint

**Solution**:
- Use `autossh` to maintain persistent connections
- Ensure you're using the same SSH key

### Subdomain Changed After Reconnect

**Symptom**: A new subdomain is assigned after reconnecting.

**Possible Causes**:
- Authentication cache expired (over 30 minutes)
- Different SSH key used

**Solution**:
- Use `autossh` to maintain persistent connections
- Reconnect within 30 minutes to preserve the same subdomain

### autossh Not Auto-Reconnecting

**Symptom**: Using autossh but it doesn't automatically reconnect.

**Troubleshooting Steps**:

1. Ensure correct parameters:
   ```bash
   autossh -M 0 \
     -o "ServerAliveInterval=30" \
     -o "ServerAliveCountMax=3" \
     -o "ExitOnForwardFailure=yes" \
     -R 80:localhost:3000 -p 2222 user@your.domain
   ```

2. Check autossh logs:
   ```bash
   export AUTOSSH_DEBUG=1
   autossh -M 0 ...
   ```

3. Ensure local service is running (`ExitOnForwardFailure=yes` exits on forward failure)

---

## Viewing Logs

```bash
# View all logs
docker compose logs -f

# View SSH service logs only
docker compose logs -f tunnl

# View Web service logs
docker compose logs -f web

# Filter error logs
docker compose logs tunnl 2>&1 | grep -i error
```
